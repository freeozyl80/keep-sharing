# 程序设计模式 && 架构设计初探

## 面向对象编程 vs 面向函数编程

### 对象设计 （封装，抽象， 继承， 多态）
  OOP, OOA, OOD

  面向对象编程：面向对象编程是一种编程范式或编程风格。它以类或对象作为组织代码的基本单元，并将封装、抽象、继承、多态四个特性，作为代码设计和实现的基石

  * 特性

  1. 封装： （https://time.geekbang.org/column/article/161114）
     
     对于封装这个特性，我们需要编程语言本身提供一定的语法机制来支持。这个语法机制就是访问权限控制： private, public
  
     解释：如果我们对类中属性的访问不做限制，那任何代码都可以访问、修改类中的属性，虽然这样看起来更加灵活，但从另一方面来说，过度灵活也意味着不可控，属性可以随意被以各种奇葩的方式修改，而且修改逻辑可能散落在代码中的各个角落，势必影响代码的可读性、可维护性

  2. 抽象：

     如何隐藏方法的具体实现：

     interface vs abstract 
     接口类

     抽象这个特性是非常容易实现的，并不需要非得依靠接口类或者抽象类这些特殊语法机制来支持。换句话说，并不是说一定要为实现类（PictureStorage）抽象出接口类（IPictureStorage），才叫作抽象。即便不编写 IPictureStorage 接口类，单纯的 PictureStorage 类本身就满足抽象特性。
     通过函数包裹的具体的实现逻辑，这本身就是一种抽象。

     而抽象作为一种只关注功能点不关注实现的设计思路，正好帮我们的大脑过滤掉许多非必要的信息

     比如基于接口而非实现编程、开闭原则（对扩展开放、对修改关闭）、代码解耦（降低代码的耦合性）

     举个简单例子，比如 getAliyunPictureUrl() 就不是一个具有抽象思维的命名，因为某一天如果我们不再把图片存储在阿里云上，而是存储在私有云上，那这个命名也要随之被修改。相反，如果我们定义一个比较抽象的函数，比如叫作 getPictureUrl()

  3. 继承

     继承最大的一个好处就是代码复用。假如两个类有一些相同的属性和方法，我们就可以将这些相同的部分，抽取到父类中，让两个子类继承父类。这样，两个子类就可以重用父类中的代码，避免代码重复写多遍。不过，这一点也并不是继承所独有的，我们也可以通过其他方式来解决这个代码复用的问题，比如利用组合关系而不是继承关系。

     继承的概念很好理解，也很容易使用。不过，过度使用继承，继承层次过深过复杂，就会导致代码可读性、可维护性变差。为了了解一个类的功能，我们不仅需要查看这个类的代码，还需要按照继承关系一层一层地往上查看“父类、父类的父类……”的代码。还有，子类和父类高度耦合，修改父类的代码，会直接影响到子类。

     所以，继承这个特性也是一个非常有争议的特性。很多人觉得继承是一种反模式。我们应该尽量少用，甚至不用。关于这个问题，在后面讲到“多用组合少用继承”这种设计思想的时候，我会非常详细地再讲解，这里暂时就不展开讲解了。

  4. 多态：

     继承加方法重写：

     接口类实现多态：

     duck-typing: //这里是个js 的例子

     ```python
     class Logger: def record(self): print(“I write a log into file.”) class DB: def record(self): print(“I insert data into db. ”) def test(recorder): recorder.record()def demo(): logger = Logger() db = DB() test(logger) test(db)
     ```
     所以说，多态提高了代码的可扩展性。

     多态也是很多设计模式、设计原则、编程技巧的代码实现基础，比如策略模式、基于接口而非实现编程、依赖倒置原则、里式替换原则、利用多态去掉冗长的 if-else 语句等等。


### 面向对象 与 面向过程
    
    * 大概区别：
    从上面的代码中，我们可以看出，面向过程和面向对象最基本的区别就是，代码的组织方式不同。面向过程风格的代码被组织成了一组方法集合及其数据结构（struct User），方法和数据结构的定义是分开的。面向对象风格的代码被组织成一组类，方法和数据结构被绑定一起，定义在类中。


    * 虚假的面相对象编程：

      购物车：（https://time.geekbang.org/column/article/164907）: 改变 items 里面的某一个值

    * 滥用全局变量和全局方法：

      Constants 类的拆解

      Utils 类 （类A 和 类B 使用相同的逻辑）// 其实是面向过程的，而且是有存在的意义的

    * 定义数据和方法分离的类：

      传统的 MVC 结构分为 Model 层、Controller 层、View 层这三层。不过，在做前后端分离之后，三层结构在后端开发中，会稍微有些调整，被分为 Controller 层、Service 层、Repository 层。Controller 层负责暴露接口给前端调用，Service 层负责核心业务逻辑，Repository 层负责数据读写。而在每一层中，我们又会定义相应的 VO（View Object）、BO（Business Object）、Entity。一般情况下，VO、BO、Entity 中只会定义数据，不会定义方法，所有操作这些数据的业务逻辑都定义在对应的 Controller 类、Service 类、Repository 类中。这就是典型的面向过程的编程风格。实际上，这种开发模式叫作基于贫血模型的开发模式，也是我们现在非常常用的一种 Web 项目的开发模式


    * 函数式编程
      
      范畴的概念：“用箭头链接的物体” ： 值 值的变形关系
      
      ``` javascript
      class Functor {
			  constructor(val) { 
			    this.val = val; 
			  }

			  map(f) {
			    return new Functor(f(this.val));
			  }
			}
			Mond 的作用和设计思想
      ```


### 再谈面相对象：
   
   * 接口 vs 抽象 ； 普通类如何模拟抽象 和 接口

     抽象类： Logger  // 不允许被实例化，只能被继承，可以包括属性和方法，子类继承必须全部实现 (功能) // 普通类 无法多态 （复用）
     接口类： Filter // 不能包含属性（成员变量），无代码实现，类实现必须实现接口中的所有方法 （协议） // 解耦


   * 基于接口而非实现编程

   	 “基于接口而非实现编程”这条原则中的“接口”，可以理解为编程语言中的接口或者抽象类。

   	 函数命名不能暴露细节：
   	 封装具体实现细节
   	 具体实现类实现统一接口。
   	 并不是每一个类都需要接口


   * 继承：嵌套过深的问题：

     组合，接口，委托

     比如，装饰者模式（decorator pattern）、策略模式（strategy pattern）、组合模式（composite pattern）等都使用了组合关系，而模板模式（template pattern）使用了继承关系

   * web 后段开发的 贫血模型的 MVC  vs DDD 领域模型（微服务）

     userService  里面 数据一个类，逻辑一个类

### 如何进行面向对象设计：

    * 划分职责区分有哪些类
    * UML图 泛化、实现、组合、依赖







* 函数编程： （https://www.ruanyifeng.com/blog/2017/02/fp-tutorial.html）

## javascritp 设计模式

## loc 控制反转 / AOP （https://juejin.cn/post/6881883342623473677?utm_source=gold_browser_extension%3Futm_source%3Dgold_browser_extension）

## 关于 Vue 的一些思考 （http://www.babyitellyou.com/details?id=60669d9a0a6c6440e0560dd5）

## DDD 领域模型




